pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
-- lander
-- by kelly

function _init()
 vx=0.0
 vy=0.0
 px=63.0
 py=20.0
 crashed=false
 over=false
 message=""
 sprite=0
 flagright=true
 makemap()
 fuel=200
 stars={}
 for i=1,64 do
  add(stars,{flr(rnd(128)),flr(rnd(2*i)),flr(rnd(2375))})
 end
 startime=0
end


function _update()

 startime+=1
 if startime>2400 then
  startime=0
 end
 
 -- thrusters --
 if not over and fuel>0 then
 	if btn(⬆️) then
 	 vy-=.1
 	 fuel-=1
 	end
 	if btn(➡️) then
   vx+=.1
   fuel-=1
  end
  if btn(⬅️) then
 	 vx-=.1
 	 fuel-=1
  end
  if fuel<0 then
   fuel=0
  end
 end

 -- gravity and movement --
 if not over then
  vy+=.05
  px+=vx
  py+=vy
 end
 
 -- collision/landing --
 if not over then
  left=mget(flr(px/8),flr((py+7)/8))
  right=mget(flr((px+7)/8),flr((py+7)/8)) 
  if fget(left,1) or fget(right,1) then
   -- crashed --
   message="unsafe landing spot"
   crashed=true
   over=true
   sprite=4
  end
  
  -- one foot on landing spot --
  if fget(left,0) and not fget(right,0) then
   -- crashed --
   message="unsafe landing spot"
   crashed=true
   over=true
   sprite=4
  end
  if fget(right,0) and not fget(left,0) then
   -- crashed --
   message="unsafe landing spot"
   crashed=true
   over=true
   sprite=4
  end
  
  if fget(left,0) and fget(right,0) then
   if abs(vx)<.11 and abs(vy)<.3 then
    -- landed --
    message="success!"
    over=true
    if mget(flr((px+10)/8),flr((py+7)/8))==16 then
     flagright=true
    else
     flagright=false
    end
   else
    -- crashed (too fast) --
    message="landed too fast"
    crashed=true
    over=true
    sprite=4
   end
  end
  -- outside viewing area --
  if px<0 or px>127 then
   if py>127 then
    -- crashed --
   message="unsafe landing spot"
   crashed=true
   over=true
   sprite=4
   end
  end
 end
 
 if over then
  vx=0
  vy=0
  print("press x to restart")
  if btnp(❎) then
 	 _init()
  end
 end
 
end


function _draw()
 cls()
 for s in all(stars) do
  if startime<s[3] or startime>s[3]+15 then
   pset(s[1],s[2],7)
  end
 end
 map()
 spr(sprite,px,py)
 
 -- thrusters --
 if not over and fuel>0 then
 	if btn(⬆️) then
 	 spr(1,px,py+8)
 	end
 	if btn(➡️) then
   spr(3,px-8,py)
  end
  if btn(⬅️) then
 	 spr(2,px+8,py)
  end
 end
 
 if not over then
  drawfuel(fuel)
  -- offscreen markers --
  if px<-7 then
   spr(21,0,py)
   if py<-7 then
    spr(21,0,0)
    spr(22,0,0)
   end
  end
  if px>127 then
   spr(21,120,py,1,1,true)
   if py<-7 then
    spr(21,120,0,1,1,true)
    spr(22,120,0)
   end
  end
  if py<-7 then
   spr(22,px,0)
  end
 end
 
 if over then
  print(message,0,0,7)
  print("press x to restart",0,7,6)
	 if not crashed then
	  if flagright then
	   spr(5,px+8,py,1,1,false,false)
	  else
	   spr(5,px-8,py,1,1,true,false)
	  end
	 end
 end
 
end
-->8
function makemap()
 -- clear map --
 for x=0,15 do
  for y=0,15 do
   mset(x,y,63)
  end
 end
 
 -- pick landing spot --
 local lx=flr(rnd(15))
 local ly=flr(11+rnd(4))
 
 -- make random ground surface --
 local yi=ly
 if lx>0 then
  for xi=lx-1,0,-1 do
   yi+=flr(rnd(5))-2
   if yi>16 then
    yi=16
   end
   mset(xi,yi,17+flr(rnd(2)))
  end
 end
 local yi=ly
 if lx<14 then
  for xi=lx+2,15 do
   yi+=flr(rnd(5))-2
   if yi>16 then
    yi=16
   end
   mset(xi,yi,17+flr(rnd(2)))
  end
 end
 
 mset(lx,ly,16)
 mset(lx+1,ly,16)
 
 for x=0,15 do
  local fill=false
  for y=0,15 do
   if fill then
    mset(x,y,19+flr(rnd(1.25)))
   end
   if mget(x,y)==16 or mget(x,y)==17 or mget(x,y)==18 then
    fill=true
   end
  end
 end
 
end
-->8
function drawfuel(f)
 local fuelpct=f/200
 local cc=7
 if fuelpct<.5 then
  cc=10
 end
 if fuelpct<.25 then
  cc=8
 end
 print("fuel",0,0,7)
 rect(17,0,127,5,6)
 if f>0 then
  rectfill(19,2,19+(125-19)*fuelpct,3,cc)
 end
end
__gfx__
00000000098888900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00766000009889000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0065660000a99a000000000000000000001001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
056667700009a0009a000000000000a9016117100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
05655770000a0000899a00000000a998016655716c80000000000000000000000000000000000000000000000000000000000000000000000000000000000000
09655690000000009a000000000000a9166556616870000000000000000000000000000000000000000000000000000000000000000000000000000000000000
09966990000000000000000000000000159766616000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
90000009000000000000000000000000999559596000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000600006066000000666666666666666660000000000077000000000000000000000000000000000000000000000000000000000000000000000000000
66666666660066666600606666666666666566660007000000700700000000000000000000000000000000000000000000000000000000000000000000000000
66666666666666666666666666666666666666660770000000700700000000000000000000000000000000000000000000000000000000000000000000000000
66666666666566666666666666666666666666667000000007000070000000000000000000000000000000000000000000000000000000000000000000000000
66666666666666666566666666666666666666567000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666666666566666666666666666666666660770000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666656666666666656666666666656666660007000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666666666666666666666666666666666660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
8888822222288ffffff8888888888888888888888888888888888888888888888888888888888888888228228888ff88ff888222822888888822888888228888
8888828888288f8888f8888888888888888888888888888888888888888888888888888888888888882288822888ffffff888222822888882282888888222888
8888822222288f8888f8888888888888888888888888888888888888888888888888888888888888882288822888f8ff8f888222888888228882888888288888
8888888888888f8888f8888888888888888888888888888888888888888888888888888888888888882288822888ffffff888888222888228882888822288888
8888828282888f8888f88888888888888888888888888888888888888888888888888888888888888822888228888ffff8888228222888882282888222288888
8888882828288ffffff88888888888888888888888888888888888888888888888888888888888888882282288888f88f8888228222888888822888222888888
88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000007777000000000000000000000000000000000000000077770000000000000000777700000000
00000000000000000000000000000000000000000000000000007777000000000000000000000000000000000000000077770000000000000000777700000000
00000000000000000000000000000000000000000000000000007777000000000000000000000000000000000000000077770000000000000000777700000000
00000000000000000000000000000000000000000000000000007777000000000000000000000000000000000000000077770000000000000000777700000000
00007777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00007777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00007777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00007777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000007777000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000007777000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000007777000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000007777000000000000000000000000000000000000000000000000
00000000000000000000000077776666666600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000077776666666600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000077776666666600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000077776666666600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000066665555666666660000000000000000000000000000000000000000000000000000000077770000000000000000000000000000
00000000000000000000000066665555666666660000000000000000000000000000000000000000000000000000000077770000000000000000000000000000
00000000000000000000000066665555666666660000000000000000000000000000000000000000000000000000000077770000000000000000000000000000
00000000000000000000000066665555666666660000000000000000000000000000000000000000000000000000000077770000000000000000000000000000
00000000000000000000555566666666666677777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000555566666666666677777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000555566666666666677777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000555566666666666677777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77770000000000000000555566665555555577777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77770000000000000000555566665555555577777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77770000000000000000555566665555555577777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77770000000000000000555566665555555577777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000999966665555555566669999000000000000000000000000000000000000000000000000777700000000000000000000000000000000
00000000000000000000999966665555555566669999000000000000000000000000000000000000000000000000777700000000000000000000000000000000
00000000000000000000999966665555555566669999000000000000000000000000000000000000000000000000777700000000000000000000000000000000
00000000000000000000999966665555555566669999000000000000000000000000000000000000000000000000777700000000000000000000000000000000
00000000000000000000999999996666666699999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000999999996666666699999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000999999996666666699999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000999999996666666699999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000009999000000000000000000000000999900000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000009999000000000000000000000000999900000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000009999000000000000000000000000999900000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000009999000000000000000000000000999900000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000999988888888888888889999000000000000777700000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000999988888888888888889999000000000000777700000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000999988888888888888889999000000000000777700000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000999988888888888888889999000000000000777700000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000099998888888899990000000000000000000000000000000000000000000000000000000000000000000000000000000077770000
00000000000000000000000099998888888899990000000000000000000000000000000000000000000000000000000000000000000000000000000077770000
00000000000000000000000099998888888899990000000000000000000000000000000000000000000000000000000000000000000000000000000077770000
00000000000000000000000099998888888899990000000000000000000000000000000000000000000000000000000000000000000000000000000077770000
000000000000000000000000aaaa99999999aaaa0000000000000000000000000000000000000000000077770000000000000000000000000000000000000000
000000000000000000000000aaaa99999999aaaa0000000000000000000000000000000000000000000077770000000000000000000000000000000000000000
000000000000000000000000aaaa99999999aaaa0000000000000000000000000000000000000000000077770000000000000000000000000000000000000000
000000000000000000000000aaaa99999999aaaa0000000000000000000000000000000000000000000077770000000000000000000000000000000000000000
00000000000000000000000000009999aaaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000009999aaaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000009999aaaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000009999aaaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000777700000000000000000000aaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000777700000000000000000000aaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000777700000000000000000000aaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000777700000000000000000000aaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000777700000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000777700000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000777700000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000777700000000000000000000
00000000000000007777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000007777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000007777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000007777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000066666666000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000066666666000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000066666666000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000066666666000000000000000000000000000000000000000000000000000000000000
00000000000066660000666666660000000000000000000000006666666666666666666600000000000000000000000000000000000000000000000000006666
00000000000066660000666666660000000000000000000000006666666666666666666600000000000000000000000000000000000000000000000000006666
00000000000066660000666666660000000000000000000000006666666666666666666600000000000000000000000000000000000000000000000000006666
00000000000066660000666666660000000000000000000000006666666666666666666600000000000000000000000000000000000000000000000000006666
00000000666666666666666666666666000000006666000066666666666666666666666600000000000000000000000000000000000000000000000066666666
00000000666666666666666666666666000000006666000066666666666666666666666600000000000000000000000000000000000000000000000066666666
00000000666666666666666666666666000000006666000066666666666666666666666600000000000000000000000000000000000000000000000066666666
00000000666666666666666666666666000000006666000066666666666666666666666600000000000000000000000000000000000000000000000066666666
66666666666666666666666666666666666666666666666666666666555566666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666555566666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666555566666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666555566666666666666666666666666666666666666666666666666666666666666666666
66665555666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666655556666
66665555666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666655556666
66665555666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666655556666
66665555666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666655556666
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888

__gff__
0000000000000000000000000000000001020202020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000011111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0011111111111010110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
